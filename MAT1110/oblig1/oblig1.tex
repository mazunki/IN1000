\documentclass{../../myassignment}
\exercisesheet{Oblig 1}{}
\courselabel{MAT1110}

\usepackage{amssymb}
\usepackage{xfrac}
\usepackage{listings}
\definecolor{codegray}{rgb}{0.7,0.7,0.7}
\definecolor{codecomment}{rgb}{0.3,0.3,0.7}
\definecolor{codekwd}{rgb}{0.7,0.3,0.3}
\definecolor{purpe}{rgb}{0.5,1.0,0.5}
\lstset{
	backgroundcolor=\color{codegray},
	commentstyle=\color{codecomment},
	keywordstyle=\color{codekwd},
	numberstyle=\tiny\color{codekwd},
	stringstyle=\color{purple},
	frame=single,
	numbers=left,
	basicstyle=\small
}

\begin{document}

	\subsection*{Oppgave 1}
		\begin{problem}
			Vi skal se på den affine avbildningen $T: R^2 \to R^2$ som speiler ethvertpunkt i planet om punktet $(-1, 1)$. Finn en $2 \times 2$-matrise $A$ og en vektor $\vec{c}$ som er slik at $T(x,y) = A \begin{pmatrix}x\\y\end{pmatrix} + \vec{c}$ for alle $x,y \in \mathbb{R}$.
		\end{problem}
	
		\begin{answer}
			Siden s{\o}ylene $e_1$ og $e_2$ er definert ved $e_1 = \begin{pmatrix} -1 \\ 0 \end{pmatrix} \land e_2 = \begin{pmatrix} 0 \\ -1 \end{pmatrix}$, og vi vet at vi reflekterer over et punkt vil $\vec{c}$ v{\ae}re $2\begin{pmatrix} -1 \\ 1 \end{pmatrix}$:
			\begin{eqnarray*}
				A &=& \begin{pmatrix} -1 & 0 \\ 0 & -1 \end{pmatrix},\\
				\vec{c} &=& \begin{pmatrix} -2 \\ 2 \end{pmatrix}\\
				\implies
				T(x,y) &=& A\begin{pmatrix}x\\y\end{pmatrix} + \vec{c} = \begin{pmatrix} -2-x \\ 2-y \end{pmatrix}
			\end{eqnarray*}
		\end{answer}

		\newpage

		\begin{problem}
			Finn lineariseringen $T_a \vec{F}$ til funksjonen definert ved 
				\begin{eqnarray*}
					\vec{F}(x,y) = \begin{pmatrix}
						x^2-2xy \\
						y^2+2xy
					\end{pmatrix}
				\end{eqnarray*}
			i punktet $a=(-1,1)$.
		\end{problem}

		\begin{answer}
			\begin{eqnarray*}
				\vec{F}(x,y) &=& \begin{pmatrix} x^2-2xy \\ y^2 + 2xy \end{pmatrix}, a=(-1,1).\\
			%\end{eqnarray*}
			%\begin{eqnarray*}
				T_{(-1,1)}(\vec{F}(x,y)) &=& \vec{F}(-1,1) + \vec{F}'(-1,1) \cdot (\begin{pmatrix} x\\y \end{pmatrix} - \begin{pmatrix} -1\\1 \end{pmatrix}) = \\
										&=& \begin{pmatrix} 1+2\\1-2 \end{pmatrix} + \begin{pmatrix} 2x-2y & -2x \\ 2y & 2y+2x \end{pmatrix}_{(-1,1)} \cdot (\begin{pmatrix} x\\y \end{pmatrix} - \begin{pmatrix} -1\\1 \end{pmatrix})\\
										&=& \begin{pmatrix} 3 \\ -1 \end{pmatrix} + \begin{pmatrix} -2-2 & 2 \\ 2 & 2-2 \end{pmatrix} \cdot (\begin{pmatrix} x\\y \end{pmatrix} - \begin{pmatrix} -1\\1 \end{pmatrix})\\
										&=& \begin{pmatrix} 3 \\ -1 \end{pmatrix} + \begin{pmatrix} -4 & 2 \\ 2 & 0 \end{pmatrix} \cdot (\begin{pmatrix} x\\y \end{pmatrix} - \begin{pmatrix} -1\\1 \end{pmatrix})\\
										&=& \begin{pmatrix} 3 \\ -1 \end{pmatrix} + \begin{pmatrix} -4x+2y \\ 2x \end{pmatrix} - \begin{pmatrix} 4+2 \\ -2+0 \end{pmatrix}\\
										&=& \begin{pmatrix} 3 \\ -1 \end{pmatrix} + \begin{pmatrix} -4x+2y-6\\ 2x-2 \end{pmatrix}\\
										&=& \begin{pmatrix} -4x+2y-3\\ 2x-3 \end{pmatrix}\\
			\end{eqnarray*}
		\end{answer}

	\newpage

	\subsection*{Oppgave 2}

	\begin{problem}
		Finn et uttrykk for jordas bane i forhold til sola (kall denne for $r_1(t)$), og et uttrykk for månens bane i forhold til jorda (kall denne for $r_2(t)$). Disse er illustrert i Figur 2. Forklar også at månens bane i forhold til sola kan parametriseres ved 
			\begin{eqnarray*}
				\vec{r}(t) = \begin{pmatrix}
					r_j cos(2\pi \frac{t}{T_j}) + r_m cos(2\pi \frac{t}{T_m}) \\
					r_j sin(2\pi \frac{t}{T_j}) + r_m sin(2\pi\frac{t}{T_m})
				\end{pmatrix},
			\end{eqnarray*}
				der tiden $t$ måles i dager.
	\end{problem}

	\begin{answer}
		\begin{align*}
			r_m &= 0.384, &r_j &= 150, \\
			T_m &= 27.3, &T_j &= 365 \\
			\omega_m &= \frac{2\pi}{T_{m}} = \frac{2\pi}{27.3} & \omega_j &= \frac{2\pi}{T_{j}} = \frac{2\pi}{365}
		\end{align*}
		\begin{align*}
			\vec{r_1}(t) &= \begin{pmatrix} r_j\cdot cos(\omega_j t)\\r_j \cdot sin(\omega_j t) \end{pmatrix} = \begin{pmatrix} r_j\cdot cos(\sfrac{2\pi}{365} \cdot t)\\r_j \cdot sin(\sfrac{2\pi}{365} \cdot t) \end{pmatrix}\\
			\vec{r_2}(t) &= \begin{pmatrix} r_m\cdot cos(\omega_m t)\\r_m \cdot sin(\omega_m t) \end{pmatrix} = \begin{pmatrix} r_m\cdot cos(\sfrac{2\pi}{27.3} \cdot t)\\r_m \cdot sin(\sfrac{2\pi}{27.3} \cdot t) \end{pmatrix}\\
		\end{align*}

		Siden funskjonene er uavhengige, og posisjonen til m{\aa}nen er relativ til jorden kan begge funsjonene summeres, da startposisjonen til m{\aa}nen alltid vil f{\o}lge jordens sentrum. Dermed blir $\vec{r}(t) = \vec{r_j}(t) + \vec{r_m}(t)$.

		\begin{align*}
			\vec{r}(t) &= \vec{r_j}(t) + \vec{r_m}(t) \\
			 &= \begin{pmatrix} r_j\cdot cos(\sfrac{2\pi}{365} \cdot t)\\r_j \cdot sin(\sfrac{2\pi}{365} \cdot t) \end{pmatrix} + \begin{pmatrix} r_m\cdot cos(\sfrac{2\pi}{27.3} \cdot t)\\r_m \cdot sin(\sfrac{2\pi}{27.3} \cdot t) \end{pmatrix} \\
			 &= \begin{pmatrix} r_j\cdot cos(\sfrac{\tau}{365} \cdot t) + r_m\cdot cos(\sfrac{\tau}{27.3} \cdot t) \\ r_j \cdot sin(\sfrac{\tau}{365} \cdot t) + r_m \cdot sin(\sfrac{\tau}{27.3} \cdot t) \end{pmatrix} \\
		\end{align*}

	\end{answer}
	
	\newpage

	\begin{problem}
		Plott $\vec{r_1}(t)$ og $\vec{r}(t)$ i samme koordinatsystem, og over en periode på ett år. Klarer du å adskille de to kurvene? Klarer du å gjenkjenne “sykloide-bevegelsene” fra Figur 1 i plottet ditt? Du trenger bare legge ved koden som lager plottet ditt, ikke selve plottet. Du kan selv velge om du bruker Matlab eller Python.
	\end{problem}
	\begin{answer}
		\lstinputlisting[language=Python]{earthmoon.py}
	\end{answer}

	\begin{problem}
		Finn et uttrykk for alle tidspunkter for fullmåne (d.v.s. når jorda ligger på en rett linje mellom månen og sola) og nymåne (månen ligger på en rettlinje mellom jorda og sola). Tidsforskjellen mellom to fullmåner kalles også synodisk omløpstid. Hva er størst av siderisk og synodisk omløpstid?	
	\end{problem}	

	\begin{answer}
		Fullm{\aa}ner og nym{\aa}ner vil begge danne en rett linje hvis vi tar solen som utgangspunkt. Det vil si at retningsvektoren fra solen til m{\aa}nen, og retningsvektoren fra solen til jorda vil v{\ae}re like. Det samme gjelder fra jorda til m{\aa}nen. Hvis vi m{\aa}ler arealet mellom to vektorer som danner ei rett linje f{\aa}r vi null. Vi {\o}nsker alts{\aa} {\aa} finne alle punktene ved $t$ der ${r_1(t)}^T \times {r_2}(t) = 0$

		\begin{align*}
			{r_1(t)}^T \times r_2(t) &= 0\\
			\begin{pmatrix} r_j\cdot cos(\sfrac{\tau}{365} \cdot t) & r_j \cdot sin(\sfrac{\tau}{365} \cdot t) \end{pmatrix} \times \begin{pmatrix} r_m\cdot cos(\sfrac{\tau}{27.3} \cdot t)\\r_m \cdot sin(\sfrac{\tau}{27.3} \cdot t) \end{pmatrix} &= 0 \\
			r_j\cdot cos(\sfrac{\tau}{365} \cdot t) \times r_m\cdot cos(\sfrac{\tau}{27.3} \cdot t) + r_j \cdot sin(\sfrac{\tau}{365} \cdot t) \times r_m \cdot sin(\sfrac{\tau}{27.3} \cdot t) &= 0 \\
			cos(\sfrac{\tau}{365} \cdot t) \times cos(\sfrac{\tau}{27.3} \cdot t) + sin(\sfrac{\tau}{365} \cdot t) \times sin(\sfrac{\tau}{27.3} \cdot t) &= 0\\
			cos(\sfrac{\tau}{365} \cdot t - \sfrac{\tau}{27.3} \cdot t) &= 0\\
			cos((\sfrac{\tau}{365} - \sfrac{\tau}{27.3}) \cdot t) &= 0\\
			&\text{Let } C = \sfrac{-337.7\tau}{9964.5}:\\
			cos(C \cdot t) &= 0\\
			t &= \sfrac{arccos(0)}{C}\\
			t &= \dfrac{\sfrac{\tau}{4} + n\tau}{C} \land \dfrac{\sfrac{3\tau}{4} + n\tau}{C}\\
			t &= \dfrac{\sfrac{\tau}{4} + \sfrac{n\tau}{2}}{C}\\
			t &= 9964.5\dfrac{\sfrac{\tau}{4} + \sfrac{n\tau}{2}}{-337.7\tau}\\
			%t &= 9964.5\dfrac{\sfrac{1}{4} + \sfrac{n}{2}}{-337.7}\\
			%t &= 9964.5\dfrac{\sfrac{3n}{4}}{-337.7}\\
			t &= 9964.5\dfrac{3n}{-1350.8}\\
			t &\approx 22.130n \\
		\end{align*}
		Ved t = -7.37674 + 14.7535n

	\end{answer}

	\begin{problem}
		Finn hastighetsvektoren $\vec{v}(t)$ og et uttrykk for farten $v(t)$ til månen i banen rundt sola. Når har månen størst og minst fart i banen sin?
	\end{problem}
\end{document}