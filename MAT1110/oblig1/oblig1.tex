\documentclass{../../myassignment}
\exercisesheet{Oblig 1}{}
\courselabel{MAT1110}

\usepackage{amssymb}
\usepackage{xfrac}
\usepackage{listings}
\definecolor{codegray}{rgb}{0.7,0.7,0.7}
\definecolor{codecomment}{rgb}{0.3,0.3,0.7}
\definecolor{codekwd}{rgb}{0.7,0.3,0.3}
\definecolor{purpe}{rgb}{0.5,1.0,0.5}
\lstset{
	backgroundcolor=\color{codegray},
	commentstyle=\color{codecomment},
	keywordstyle=\color{codekwd},
	numberstyle=\tiny\color{codekwd},
	stringstyle=\color{purple},
	frame=single,
	numbers=left,
	basicstyle=\small
}

\begin{document}

	\subsection*{Oppgave 1}
		\begin{problem}
			Vi skal se på den affine avbildningen $T: R^2 \to R^2$ som speiler ethvertpunkt i planet om punktet $(-1, 1)$. Finn en $2 \times 2$-matrise $A$ og en vektor $\vec{c}$ som er slik at $T(x,y) = A \begin{pmatrix}x\\y\end{pmatrix} + \vec{c}$ for alle $x,y \in \mathbb{R}$.
		\end{problem}
	
		\begin{answer}
			Siden s{\o}ylene $e_1$ og $e_2$ er definert ved $e_1 = \begin{pmatrix} -1 \\ 0 \end{pmatrix} \land e_2 = \begin{pmatrix} 0 \\ -1 \end{pmatrix}$, og vi vet at vi reflekterer over et punkt vil $\vec{c}$ v{\ae}re $2\begin{pmatrix} -1 \\ 1 \end{pmatrix}$:
			\begin{eqnarray*}
				A &=& \begin{pmatrix} -1 & 0 \\ 0 & -1 \end{pmatrix},\\
				\vec{c} &=& \begin{pmatrix} -2 \\ 2 \end{pmatrix}\\
				\implies
				T(x,y) &=& A\begin{pmatrix}x\\y\end{pmatrix} + \vec{c} = \begin{pmatrix} -2-x \\ 2-y \end{pmatrix}
			\end{eqnarray*}
		\end{answer}

		\newpage

		\begin{problem}
			Finn lineariseringen $T_a \vec{F}$ til funksjonen definert ved 
				\begin{eqnarray*}
					\vec{F}(x,y) = \begin{pmatrix}
						x^2-2xy \\
						y^2+2xy
					\end{pmatrix}
				\end{eqnarray*}
			i punktet $a=(-1,1)$.
		\end{problem}

		\begin{answer}
			\begin{eqnarray*}
				\vec{F}(x,y) &=& \begin{pmatrix} x^2-2xy \\ y^2 + 2xy \end{pmatrix}, a=(-1,1).\\
			%\end{eqnarray*}
			%\begin{eqnarray*}
				T_{(-1,1)}(\vec{F}(x,y)) &=& \vec{F}(-1,1) + \vec{F}'(-1,1) \cdot (\begin{pmatrix} x\\y \end{pmatrix} - \begin{pmatrix} -1\\1 \end{pmatrix}) = \\
										&=& \begin{pmatrix} 1+2\\1-2 \end{pmatrix} + \begin{pmatrix} 2x-2y & -2x \\ 2y & 2y+2x \end{pmatrix}_{(-1,1)} \cdot (\begin{pmatrix} x\\y \end{pmatrix} - \begin{pmatrix} -1\\1 \end{pmatrix})\\
										&=& \begin{pmatrix} 3 \\ -1 \end{pmatrix} + \begin{pmatrix} -2-2 & 2 \\ 2 & 2-2 \end{pmatrix} \cdot (\begin{pmatrix} x\\y \end{pmatrix} - \begin{pmatrix} -1\\1 \end{pmatrix})\\
										&=& \begin{pmatrix} 3 \\ -1 \end{pmatrix} + \begin{pmatrix} -4 & 2 \\ 2 & 0 \end{pmatrix} \cdot (\begin{pmatrix} x\\y \end{pmatrix} - \begin{pmatrix} -1\\1 \end{pmatrix})\\
										&=& \begin{pmatrix} 3 \\ -1 \end{pmatrix} + \begin{pmatrix} -4x+2y \\ 2x \end{pmatrix} - \begin{pmatrix} 4+2 \\ -2+0 \end{pmatrix}\\
										&=& \begin{pmatrix} 3 \\ -1 \end{pmatrix} + \begin{pmatrix} -4x+2y-6\\ 2x-2 \end{pmatrix}\\
										&=& \begin{pmatrix} -4x+2y-3\\ 2x-3 \end{pmatrix}\\
			\end{eqnarray*}
		\end{answer}

	\newpage

	\subsection*{Oppgave 2}

	\begin{problem}
		Finn et uttrykk for jordas bane i forhold til sola (kall denne for $r_1(t)$), og et uttrykk for månens bane i forhold til jorda (kall denne for $r_2(t)$). Disse er illustrert i Figur 2. Forklar også at månens bane i forhold til sola kan parametriseres ved 
			\begin{eqnarray*}
				\vec{r}(t) = \begin{pmatrix}
					r_j cos(2\pi \frac{t}{T_j}) + r_m cos(2\pi \frac{t}{T_m}) \\
					r_j sin(2\pi \frac{t}{T_j}) + r_m sin(2\pi\frac{t}{T_m})
				\end{pmatrix},
			\end{eqnarray*}
				der tiden $t$ måles i dager.
	\end{problem}

	\begin{answer}
		\begin{align*}
			r_m &= 0.384, &r_j &= 150, \\
			T_m &= 27.3, &T_j &= 365 \\
			\omega_m &= \frac{2\pi}{T_{m}} = \frac{2\pi}{27.3} & \omega_j &= \frac{2\pi}{T_{j}} = \frac{2\pi}{365}
		\end{align*}
		\begin{align*}
			\vec{r_1}(t) &= \begin{pmatrix} r_j\cdot cos(\omega_j t)\\r_j \cdot sin(\omega_j t) \end{pmatrix} = \begin{pmatrix} r_j\cdot cos(\sfrac{2\pi}{365} \cdot t)\\r_j \cdot sin(\sfrac{2\pi}{365} \cdot t) \end{pmatrix}\\
			\vec{r_2}(t) &= \begin{pmatrix} r_m\cdot cos(\omega_m t)\\r_m \cdot sin(\omega_m t) \end{pmatrix} = \begin{pmatrix} r_m\cdot cos(\sfrac{2\pi}{27.3} \cdot t)\\r_m \cdot sin(\sfrac{2\pi}{27.3} \cdot t) \end{pmatrix}\\
		\end{align*}

		Siden funskjonene er uavhengige, og posisjonen til m{\aa}nen er relativ til jorden kan begge funsjonene summeres, da startposisjonen til m{\aa}nen alltid vil f{\o}lge jordens sentrum. Dermed blir $\vec{r}(t) = \vec{r_j}(t) + \vec{r_m}(t)$.

		\begin{align*}
			\vec{r}(t) &= \vec{r_j}(t) + \vec{r_m}(t) \\
			 &= \begin{pmatrix} r_j\cdot cos(\sfrac{2\pi}{365} \cdot t)\\r_j \cdot sin(\sfrac{2\pi}{365} \cdot t) \end{pmatrix} + \begin{pmatrix} r_m\cdot cos(\sfrac{2\pi}{27.3} \cdot t)\\r_m \cdot sin(\sfrac{2\pi}{27.3} \cdot t) \end{pmatrix} \\
			 &= \begin{pmatrix} r_j\cdot cos(\sfrac{\tau}{365} \cdot t) + r_m\cdot cos(\sfrac{\tau}{27.3} \cdot t) \\ r_j \cdot sin(\sfrac{\tau}{365} \cdot t) + r_m \cdot sin(\sfrac{\tau}{27.3} \cdot t) \end{pmatrix} \\
		\end{align*}

	\end{answer}
	
	\newpage

	\begin{problem}
		Plott $\vec{r_1}(t)$ og $\vec{r}(t)$ i samme koordinatsystem, og over en periode på ett år. Klarer du å adskille de to kurvene? Klarer du å gjenkjenne “sykloide-bevegelsene” fra Figur 1 i plottet ditt? Du trenger bare legge ved koden som lager plottet ditt, ikke selve plottet. Du kan selv velge om du bruker Matlab eller Python.
	\end{problem}
	\begin{answer}
		\lstinputlisting[language=Python]{earthmoon.py}
		Som kommentert har jeg endret radiusen fra jorda til m{\aa}nen for visuelle nytelsen.
	\end{answer}
	\newpage
	\begin{problem}
		Finn et uttrykk for alle tidspunkter for fullmåne (d.v.s. når jorda ligger på en rett linje mellom månen og sola) og nymåne (månen ligger på en rettlinje mellom jorda og sola). Tidsforskjellen mellom to fullmåner kalles også synodisk omløpstid. Hva er størst av siderisk og synodisk omløpstid?	
	\end{problem}	

	\begin{answer}
		Fullm{\aa}ner og nym{\aa}ner vil begge danne en rett linje hvis vi tar solen som utgangspunkt. Det vil si at retningsvektoren fra solen til m{\aa}nen, og retningsvektoren fra solen til jorda vil v{\ae}re like. Det samme gjelder fra jorda til m{\aa}nen. Hvis vi m{\aa}ler arealet mellom to vektorer som danner ei rett linje f{\aa}r vi null. Vi {\o}nsker alts{\aa} {\aa} finne alle punktene ved $t$ der $det (\begin{bmatrix}{\vec{r_1}(t)} \\ {\vec{r_2}}(t)\end{bmatrix}) = 0$

		\begin{align*}
			\begin{vmatrix}{\vec{r_2}(t)} \\ \vec{r_1}(t) \end{vmatrix} &= 0\\
			\begin{pmatrix} r_m\cdot cos(\omega_m \cdot t) & r_m \cdot sin(\omega_m \cdot t) \\ r_j\cdot cos(\omega_j \cdot t) & r_j \cdot sin(\omega_j \cdot t) \end{pmatrix} &= 0 \\
			r_m\cdot cos(\omega_m \cdot t) \times r_j \cdot sin(\omega_j \cdot t) - r_m \cdot sin(\omega_m \cdot t) \times r_j\cdot cos(\omega_j \cdot t) &= 0 \\
			-r_m \cdot r_j \cdot sin(w_m \cdot t - w_j \cdot t) &= 0 \\
			sin(w_m \cdot t - w_j \cdot t) &= 0 \\
			sin((w_m - w_j)t) &= 0 \\
			(w_m - w_j)t &= arcsin(0) \\
			(\sfrac{\tau}{27.3} - \sfrac{\tau}{365})t &= arcsin(0) \\
			\sfrac{(365\tau - 27.3\tau)}{9964.5} \cdot t &= arcsin(0) \\
			t &= \dfrac{9964.5 \cdot arcsin(0)}{337.7\tau} \\
			t &\approx 29.507 \cdot \dfrac{arcsin(0)}{\tau} \\
			t &\approx 29.507 \cdot \dfrac{n \cdot \sfrac{\tau}{2}}{\tau} \\
			t &\approx 29.507 \cdot \dfrac{n}{2} = 14.753\cdot n \\
		\end{align*}
		Ved $t_n = 14.753n$, der $n \in \mathbb{N}$ vil vi observere enten fullm{\aa}ne eller nym{\aa}ne. Siden vi ikke har tatt i betraktning at jorden roterer over sin egen akse, og siden vi vet at m{\aa}nen sin periode over jorden er under en tiendedel (alts{\aa} ganske mye lavere) av jorden sin periode rundt solen er det nok og si at fullm{\aa}ne og nym{\aa}ne kommer annehvert. Ved {\aa} sjekke ved $t_0$ ser vi at $\vec{r_1}(t_0) = 150.384$ som tilsvarer, pga. avrunding, $r_j + r_m$. Dette er alts{\aa} en fullm{\aa}ne. Ved $n=2i, i\in\mathbb{N}$ vil vi se fullm{\aa}ner, og ved $n=2i+1$ vil vi se nym{\aa}ner.

		Den synodiske oml{\o}pstiden er st{\o}rre en den sideriske, i og med at m{\aa}nen m{\aa}nen m{\aa}, i tilleg til {\aa} g{\aa}rundt jorda, m{\aa} den ogs{\aa} f{\o}lge etter jorda, og dermed tar en syonodisk runde mer en $\tau$ radianer.
	\end{answer}

	\newpage

	\begin{problem}
		Finn hastighetsvektoren $\vec{v}(t)$ og et uttrykk for farten $v(t)$ til månen i banen rundt sola. Når har månen størst og minst fart i banen sin?
	\end{problem}
	\begin{answer}
		\begin{align}
			\vec{r}(t) &= \begin{pmatrix} r_j \cdot cos(\omega_j t) + r_m \cdot cos(\omega_m t) \\ r_j \cdot sin(\omega_j t) + r_m \cdot sin(\omega_m t) \end{pmatrix} \\
			\vec{v}(t) = \vec{r}\,'(t) &= \begin{pmatrix} - r_j \cdot sin(\omega_j t) \cdot \omega_j - r_m \cdot sin(\omega_m t) \cdot \omega_m \\ r_j \cdot cos(\omega_j t) \cdot \omega_j + r_m \cdot cos(\omega_m t) \cdot \omega_m \end{pmatrix} \\
			v(t) = |\vec{v}(t)| &= \sqrt{[- r_j \cdot sin(\omega_j t) \cdot \omega_j - r_m \cdot sin(\omega_m t) \cdot \omega_m]^2 + [r_j \cdot cos(\omega_j t) \cdot \omega_j + r_m \cdot cos(\omega_m t) \cdot \omega_m]^2 } \\
			v(t) &= \sqrt{[- C_j \cdot sin(\omega_j t) - C_m \cdot sin(\omega_m t)]^2 + [C_j \cdot cos(\omega_j t) + C_m \cdot cos(\omega_m t)]^2 }, \text{where } C_i = \omega_i r_i \\
			v(t) &= \sqrt{
				\begin{aligned}
					&[C_j\,^2 \cdot sin^2(\omega_j t) + 2C_jC_m\cdot sin(w_j t)sin(w_m t) + C_m\,^2 \cdot sin^2(\omega_m t)] + \\
					&[C_j\,^2 \cdot cos^2(\omega_j t) + 2C_jC_m\cdot cos(w_j t)cos(w_m t) + C_m\,^2 \cdot cos^2(\omega_m t)]
				\end{aligned}
				}\\
			v(t) &= \sqrt{
				\begin{aligned}
					& C_j\,^2 [sin^2(\omega_j t)+cos^2(\omega_j t)] + \\
					& 2C_jC_m [sin(w_j t)sin(w_m t) + cos(w_j t)cos(w_m t)] + \\
					& C_m\,^2 [sin^2(\omega_m t) + cos^2(\omega_m t)]
				\end{aligned}
				}\\
				v(t) &= \sqrt{ C_j\,^2 + 2C_jC_m \cdot cos((\omega_m - \omega_j)t) + C_m\,^2 }\\
				v(t) &= \sqrt{ (\omega_j\cdot r_j)\,^2 + 2\omega_j\omega_m r_j r_m \cdot cos((\omega_m - \omega	_j)t) + (\omega_m r_m)\,^2 }\\
				v(t) &= \sqrt{ (150\sfrac{\tau}{365})\,^2 + 2\cdot150\cdot0.384\sfrac{\tau}{365}\sfrac{\tau}{27.3} \cdot cos((\sfrac{\tau}{27.3} - \sfrac{\tau}{365})t) + ( 0.384\sfrac{\tau}{27.3})\,^2 }\\
				v(t) &= \sqrt{ (30\sfrac{\tau}{73})\,^2 + 115.2\sfrac{\tau^2}{9964.5} \cdot cos(t\cdot \sfrac{337.7\tau}{9964.5}) + ( 0.384\sfrac{\tau}{27.3})\,^2 }
		\end{align}
	\end{answer}

	\begin{answer}
		N{\aa}r $cos(t\cdot \sfrac{337.7\tau}{9964.5})$ er lik $-1$ og $1$ finner vi maksimum- og minimums-verdiene til farten. 
		Minimumsverdiene finner vi ved:
			\begin{align}
			 	cos(t\cdot \sfrac{337.7\tau}{9964.5}) &= -1 \\
			 	t\cdot \sfrac{337.7\tau}{9964.5} &= arccos(-1) \\
			 	t_n &= \frac{9964.5}{337.7\tau} (\sfrac{\tau}{2}+n \tau)\\
			 	t_n &= \frac{9964.5}{337.7} (n + \sfrac{1}{2})
			 \end{align}
		Maksimumsverdiene finner vi ved:
			\begin{align}
			 	cos(t\cdot \sfrac{337.7\tau}{9964.5}) &= 1 \\
			 	t\cdot \sfrac{337.7\tau}{9964.5} &= arccos(1) \\
			 	t_n &= \frac{9964.5}{337.7\tau} (n \tau)\\
			 	t_n &= \frac{9964.5}{337.7} (n)
			 \end{align}
	\end{answer}
\end{document}